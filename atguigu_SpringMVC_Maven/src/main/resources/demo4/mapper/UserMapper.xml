<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sakanal.mvc.demo4.dao.UserMapper">
    <insert id="insertUser">
        insert into `user`(<include refid="myUserInsert"/>) value(<include refid="myUserInsertValue"/>)
    </insert>

    <update id="updateUser">
        update `user`
            <set>
                <if test="name!=null and name!=''">name=#{name},</if>
                <if test="password!=null and password!=''">password=#{password},</if>
                <if test="gender!=null and gender!=''">gender=#{gender},</if>
                <if test="address!=null and address!=''">address=#{address},</if>
                <if test="phone!=null and phone!=''">phone=#{phone},</if>
                <if test="department_id!=null">department_id=#{department_id},</if>
            </set>
            where id=#{id}
    </update>

    <delete id="deleteUser">
        <if test="id!=null">
            delete from `user` where id=#{id}
        </if>
    </delete>

    <select id="getUsers" resultType="com.sakanal.mvc.demo4.pojo.User">
        select * from `user`
    </select>
    <select id="getUserByLike" resultType="com.sakanal.mvc.demo4.pojo.User">
        select * from `user`
            <trim prefix="where" suffixOverrides="and">
                <if test="id!=null">id=#{id} and</if>
                <if test="name!=null and name!=''">name like CONCAT('%',#{name},'%') and</if>
                <if test="password!=null and password!=''">password like CONCAT('%',#{password},'%') and</if>
                <if test="gender!=null and gender!=''">gender like CONCAT('%',#{gender},'%') and</if>
                <if test="address!=null and address!=''">address like CONCAT('%',#{address},'%') and</if>
                <if test="phone!=null and phone!=''">phone like CONCAT('%',#{phone},'%') and</if>
                <if test="department_id!=null">department_id=#{department_id} and</if>
            </trim>
    </select>

    <sql id="myUserInsert">
        id,name,password,gender,address,phone,department_id
    </sql>
    <sql id="myUserInsertValue">
        #{id},#{name},#{password},#{gender},#{address},#{phone},#{department_id}
    </sql>
</mapper>